<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Sixian Zhang, Zaoyi Chi, Hao Wang" />

<meta name="date" content="2019-02-15" />

<title>Report for project 1 on K Nearest Neighbors</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Report for project 1 on K Nearest Neighbors</h1>
<h4 class="author"><em>Sixian Zhang, Zaoyi Chi, Hao Wang</em></h4>
<h4 class="date"><em>2019-02-15</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>For this project we created an R package with C++ code that implements a version of the nearest neighbors algorithm.</p>
<p>Here are some significant formulas that have been used in this function:</p>
<p><strong>Manhattan distance: </strong> <strong><span class="math inline">\(d(i,j)=\sum_{1}^{n}(|X_1-X_2|+|Y_1-Y_2|)\)</span></strong></p>
<p><strong>Nearest neighbor prediction function: </strong> <strong><span class="math inline">\(f_{D,k(x)} = \frac{1}{k} \sum_{i\in N_{D,k}}^{n} y_i\)</span></strong></p>
<p><strong>The optimal number of neighbors: </strong> <strong><span class="math inline">\(\hat{k} = argmin_{k\in (1,2,...,k_{max})} \frac{1}{F_{max}} \sum_{S=1}^{F_{max}} Error_{Ds}(f_{D,-S,k})\)</span></strong> *(as estimated via minimizing the mean validation loss).</p>
</div>
<div id="main-function" class="section level2">
<h2>Main Function</h2>
<p>The purpose of this section is to give users a general information of this package. We will briefly go over the main functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Source Code:
## 1-3:
binary.base.loss &lt;-<span class="st"> </span><span class="cf">function</span>(y.vec, fold.vec, n.folds){
  base.loss =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, n.folds))
  index1 &lt;-<span class="st"> </span><span class="kw">which</span>(y.vec <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
  index0 &lt;-<span class="st"> </span><span class="kw">which</span>(y.vec <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
  <span class="cf">if</span> (<span class="kw">length</span>(index1) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">length</span>(index0)){
    base.predict &lt;-<span class="st"> </span><span class="dv">1</span>
  }<span class="cf">else</span>{
    base.predict &lt;-<span class="st"> </span><span class="dv">0</span>
  }
  
  <span class="cf">for</span> (fold.i <span class="cf">in</span> <span class="kw">seq</span>(n.folds)){
    validation.index =<span class="st"> </span><span class="kw">which</span>(fold.vec <span class="op">==</span><span class="st"> </span>fold.i)
    num.valid &lt;-<span class="st"> </span><span class="kw">length</span>(validation.index)
    base.predict.vec &lt;-<span class="st"> </span><span class="kw">rep</span>(base.predict, num.valid)
    num.miss.index &lt;-<span class="st"> </span><span class="kw">which</span>((base.predict.vec <span class="op">!=</span><span class="st"> </span>y.vec[validation.index]) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
    base.loss[fold.i] =<span class="st"> </span><span class="kw">length</span>(num.miss.index) <span class="op">/</span><span class="st"> </span>num.valid 
  } 
  base.loss
}

## 4-5:
<span class="kw">library</span>(NearestNeighbors)
BaselinePredict &lt;-<span class="st"> </span><span class="cf">function</span>(y.vec, fold.vec, n.folds) {
  prediction &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, n.folds)
  prediction.loss &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, n.folds)
  <span class="cf">for</span> (fold.i <span class="cf">in</span> <span class="kw">seq_len</span>(n.folds)) {
    train.index &lt;-<span class="st"> </span><span class="kw">which</span>(fold.vec <span class="op">!=</span><span class="st"> </span>fold.i)
    validation.index &lt;-<span class="st"> </span><span class="kw">which</span>(fold.vec <span class="op">==</span><span class="st"> </span>fold.i)
    prediction[fold.i] &lt;-<span class="st"> </span><span class="kw">mean</span>(y.vec[train.index])
    prediction.loss[fold.i] &lt;-
<span class="st">      </span><span class="kw">mean</span>((y.vec[validation.index] <span class="op">-</span><span class="st"> </span>prediction[fold.i]) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)
  }
  <span class="kw">return</span>(prediction.loss)
}</code></pre></div>
</div>
<div id="experimentsapplication" class="section level2">
<h2>Experiments/application</h2>
<p>we are going to run our code on the following data sets.</p>
</div>
<div id="data-set-1-spam" class="section level2">
<h2>Data set 1: spam</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Data 1: spam</span>
<span class="co">#----------------------Data Initialization-------------------------------</span>
<span class="kw">data</span>(spam, <span class="dt">package =</span> <span class="st">&quot;ElemStatLearn&quot;</span>)
n.folds =<span class="st"> </span>3L
X.mat &lt;-<span class="st"> </span><span class="kw">data.matrix</span>(<span class="kw">subset</span>(spam,<span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(spam)))
y.vec &lt;-<span class="st"> </span>spam<span class="op">$</span>spam
<span class="kw">levels</span>(y.vec) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)
y.vec &lt;-<span class="st"> </span><span class="kw">as.double</span>(<span class="kw">as.vector</span>(y.vec))
testX.mat &lt;-<span class="st"> </span>X.mat[<span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">nrow</span>(X.mat)),]
max.neighbors &lt;-<span class="st"> </span>30L
fold.vec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.folds, <span class="dt">l =</span> <span class="kw">nrow</span>(X.mat)))
<span class="co">#------------------------------------------------------------------------</span>

<span class="co">#-------------------Prediction vs original data--------------------------</span>
<span class="co">#X.mat: double matrix; y.vec: double vector; testX.mat: samller double matrix</span>
C.pred.model &lt;-<span class="st"> </span><span class="kw">NNLearnCV</span>(X.mat, y.vec, max.neighbors, fold.vec, n.folds)
prediction.output &lt;-<span class="st"> </span>C.pred.model<span class="op">$</span><span class="kw">predict</span>(testX.mat)
original.output &lt;-<span class="st"> </span>y.vec[<span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">nrow</span>(X.mat))]
pred.vs.og &lt;-<span class="st"> </span><span class="kw">rbind</span>(original.output, prediction.output)
<span class="kw">colnames</span>(pred.vs.og) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Test1&quot;</span>,<span class="st">&quot;Test2&quot;</span>)
pred.vs.og
<span class="co">#&gt;                   Test1 Test2</span>
<span class="co">#&gt; original.output       1     0</span>
<span class="co">#&gt; prediction.output     1     0</span>
<span class="co">#-------------------------------------------------------------------------</span>

<span class="co"># ouput 2x3 matirx of nearst-neighbor-predicaton accuracy VS base-line prediction</span>
base.loss &lt;-<span class="st"> </span><span class="kw">binary.base.loss</span>(y.vec, fold.vec, n.folds)
nnp.predict.loss &lt;-<span class="st"> </span><span class="kw">colMeans</span>(C.pred.model<span class="op">$</span>validation.loss.mat)
nnploss.vs.baseloss &lt;-<span class="st"> </span><span class="kw">rbind</span>(nnp.predict.loss, base.loss)
<span class="kw">colnames</span>(nnploss.vs.baseloss) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Fold1&quot;</span>,<span class="st">&quot;Fold2&quot;</span>,<span class="st">&quot;Fold3&quot;</span>)
nnploss.vs.baseloss
<span class="co">#&gt;                      Fold1     Fold2     Fold3</span>
<span class="co">#&gt; nnp.predict.loss 0.1906562 0.1747936 0.1720374</span>
<span class="co">#&gt; base.loss        0.4093872 0.3963494 0.3763862</span>
<span class="co">#------------------------------------------------------------------------------</span></code></pre></div>
<div id="matrix-of-loss-values" class="section level3">
<h3>Matrix of loss values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(
  nnploss.vs.baseloss,
  <span class="dt">main =</span> <span class="st">&quot;Binary Classification: spam&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;mean loss value&quot;</span>,
  <span class="dt">legend =</span> (<span class="kw">rownames</span>(nnploss.vs.baseloss)),
  <span class="dt">beside =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Difference between NN and baseline: <strong>The mean loss value of the NN prediction is typically smaller than the Baseline prediction.</strong></p>
</div>
<div id="trainvalidation-loss-plot" class="section level3">
<h3>Train/validation loss plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">matplot</span>(
  <span class="dt">y =</span> <span class="kw">cbind</span>(C.pred.model<span class="op">$</span>validation.loss.vec, C.pred.model<span class="op">$</span>train.loss.vec),
  <span class="dt">xlab =</span> <span class="st">&quot;neighbors&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;mean loss value&quot;</span>,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">pch =</span> <span class="dv">15</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">17</span>)
)

dot.x &lt;-<span class="st"> </span>C.pred.model<span class="op">$</span>selected.neighbors
dot.y &lt;-<span class="st"> </span>C.pred.model<span class="op">$</span>validation.loss.vec[dot.x]
<span class="kw">matpoints</span>(<span class="dt">x =</span> dot.x,
          <span class="dt">y =</span> dot.y,
          <span class="dt">col =</span> <span class="dv">2</span>,
          <span class="dt">pch =</span> <span class="dv">19</span>)
<span class="kw">legend</span>(
  <span class="dt">x =</span> max.neighbors,
  <span class="dv">0</span>,
  <span class="kw">c</span>(<span class="st">&quot;Validation loss&quot;</span>, <span class="st">&quot;Train loss&quot;</span>),
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">xjust =</span> <span class="dv">1</span>,
  <span class="dt">yjust =</span> <span class="dv">0</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The optimal number of neighbors is: <strong>1</strong></p>
</div>
</div>
<div id="data-set-2-saheart" class="section level2">
<h2>Data set 2: SAheart</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Data 2: SAheart</span>
<span class="co">#--------------------Data Initalization---------------------------</span>
<span class="kw">data</span>(SAheart, <span class="dt">package =</span> <span class="st">&quot;ElemStatLearn&quot;</span>)
n.folds =<span class="st"> </span>3L
X.mat &lt;-<span class="st"> </span><span class="kw">data.matrix</span>(<span class="kw">subset</span>(SAheart, <span class="dt">select =</span> <span class="op">-</span><span class="dv">10</span>))
y.vec &lt;-<span class="st"> </span>SAheart[,<span class="dv">10</span>]
y.vec &lt;-<span class="st"> </span><span class="kw">as.double</span>(<span class="kw">as.vector</span>(y.vec))
testX.mat &lt;-<span class="st"> </span>X.mat[<span class="kw">c</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(X.mat)<span class="op">-</span><span class="dv">1</span>),]
max.neighbors &lt;-<span class="st"> </span>30L
fold.vec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.folds, <span class="dt">l =</span> <span class="kw">nrow</span>(X.mat)))
<span class="co">#------------------------------------------------------------------</span>
<span class="co">#-----------------------Prediction vs original data----------------</span>
C.pred.model &lt;-<span class="st"> </span><span class="kw">NNLearnCV</span>(X.mat, y.vec, max.neighbors, fold.vec, n.folds)
prediction.output &lt;-<span class="st"> </span>C.pred.model<span class="op">$</span><span class="kw">predict</span>(testX.mat)
original.output &lt;-<span class="st"> </span>y.vec[<span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">nrow</span>(X.mat))]
pred.vs.og &lt;-<span class="st"> </span><span class="kw">rbind</span>(original.output, prediction.output)
<span class="kw">colnames</span>(pred.vs.og) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Test1&quot;</span>,<span class="st">&quot;Test2&quot;</span>)
pred.vs.og
<span class="co">#&gt;                       Test1     Test2</span>
<span class="co">#&gt; original.output   1.0000000 1.0000000</span>
<span class="co">#&gt; prediction.output 0.4444444 0.3333333</span>
<span class="co">#-------------------------------------------------------------------------</span>

<span class="co"># ouput 2x3 matirx of nearst-neighbor-predicaton accuracy VS base-line prediction</span>
base.loss &lt;-<span class="st"> </span><span class="kw">binary.base.loss</span>(y.vec, fold.vec, n.folds)
nnp.predict.loss &lt;-<span class="st"> </span><span class="kw">colMeans</span>(C.pred.model<span class="op">$</span>validation.loss.mat)
nnploss.vs.baseloss &lt;-<span class="st"> </span><span class="kw">rbind</span>(nnp.predict.loss, base.loss)
<span class="kw">colnames</span>(nnploss.vs.baseloss) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Fold1&quot;</span>,<span class="st">&quot;Fold2&quot;</span>,<span class="st">&quot;Fold3&quot;</span>)
nnploss.vs.baseloss
<span class="co">#&gt;                      Fold1     Fold2     Fold3</span>
<span class="co">#&gt; nnp.predict.loss 0.3318182 0.3688312 0.3651515</span>
<span class="co">#&gt; base.loss        0.2857143 0.3831169 0.3701299</span></code></pre></div>
<div id="matrix-of-loss-values-1" class="section level3">
<h3>Matrix of loss values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(
  nnploss.vs.baseloss,
  <span class="dt">main =</span> <span class="st">&quot;Binary Classification: SAheart&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;mean loss value&quot;</span>,
  <span class="dt">legend =</span> (<span class="kw">rownames</span>(nnploss.vs.baseloss)),
  <span class="dt">beside =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Difference between NN and baseline:</p>
<p><strong>The mean loss value of the NN prediction is similar to the Baseline prediction. Since SAheart dataset is small dataset with binary calsses. The general binary baseline priction is good for small dataset, becasue it relies on most of data in a samll set and can predict the most of of cases correctly.</strong></p>
</div>
<div id="trainvalidation-loss-plot-1" class="section level3">
<h3>Train/validation loss plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
dot.x &lt;-<span class="st"> </span>C.pred.model<span class="op">$</span>selected.neighbors
dot.y &lt;-<span class="st"> </span>C.pred.model<span class="op">$</span>validation.loss.vec[dot.x]

<span class="kw">matplot</span>(
  <span class="dt">y =</span> <span class="kw">cbind</span>(C.pred.model<span class="op">$</span>validation.loss.vec, C.pred.model<span class="op">$</span>train.loss.vec),
  <span class="dt">xlab =</span> <span class="st">&quot;neighbors&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;mean loss value&quot;</span>,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">pch =</span> <span class="dv">15</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">17</span>)
)

<span class="kw">matpoints</span>(<span class="dt">x =</span> dot.x,
          <span class="dt">y =</span> dot.y,
          <span class="dt">col =</span> <span class="dv">2</span>,
          <span class="dt">pch =</span> <span class="dv">19</span>)


<span class="kw">legend</span>(
  <span class="dt">x =</span> max.neighbors,
  <span class="dv">0</span>,
  <span class="kw">c</span>(<span class="st">&quot;Validation loss&quot;</span>, <span class="st">&quot;Train loss&quot;</span>),
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">xjust =</span> <span class="dv">1</span>,
  <span class="dt">yjust =</span> <span class="dv">0</span>
)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAJACAMAAABSRCkEAAAAbFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmkJBmtrZmtv+QOgCQkGaQtpCQ2/+2ZgC2tma225C2///bkDrb2//b/7bb/9vb////AAD/tmb/25D//7b//9v///8RKPliAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAU4ElEQVR4nO2di3qjOpZGSU2Sc3ri6k5Oxz1Fd6dsx+//jmNxM76AQb8EW7DW91WcGLwl5FVCEkJkRwCBbO4MQNogEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEgEFiiDhTCXQGHDwVwgEEggEEggEEhEFWj/+h4yHBgkikCHzbmR/uOXHA4ME6cG2mVv7oUaaPlEOoUdNs9fCLQGorWBtk+fCLQC4jWi8+wNgZZPxF7Y/vV/EGjxxOzGf39kCLR0GEgEidgC5YwDLZuJa6DxswCqjwVJHcKTxCksQyGzpCJQUXmFzQKEIJJApw5Y35WwceGafVHIHnEEystrYc1FMSlce9fbamh0ewqCEkWg749Gm9xdE5PC3RpTvZwb4xg0H5GmczQDiDu5G3+7500vDoHmw3wNNGhHDJqNWG2gqgqS20AD98OguYg2H6hsoXTUPwi0GMyMA92PP1f2YChmBLo7yOPZ2YfpsCPQXanEiBAdSwLdVELjr3fA1JgS6OrtkUli0BwYE6hdCY1OEYNmwJpA7Uun4WJCNOwJ1FzsChoUImFQoHKjV3oYNDkmBXKVEAKlgU2BvJPDoKmxKpC1uNDB0gTCoIlBIJBYnEAYNC3LEwiDJmWBAmHQlCxRIAyakEUKhEHTsUyBMGgyFioQBk3FUgXiPvqJWKxAVELTsGCBMGgKlizQnZvP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" /><!-- --></p>
<p>The optimal number of neighbors is: <strong>27</strong></p>
</div>
</div>
<div id="data-set-3-zip.train" class="section level2">
<h2>Data set 3: zip.train</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Data 3: zip.train</span>
<span class="co">#--------------------Data Initalization---------------------------</span>
<span class="kw">data</span>(zip.train, <span class="dt">package =</span> <span class="st">&quot;ElemStatLearn&quot;</span>)
n.folds =<span class="st"> </span>3L
entire.mat &lt;-<span class="st"> </span><span class="kw">data.matrix</span>(zip.train)
y.vec &lt;-<span class="st"> </span>entire.mat[,<span class="dv">1</span>]
binary.index &lt;-<span class="st"> </span><span class="kw">which</span>((y.vec <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">|</span><span class="st"> </span>(y.vec <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))
X.mat &lt;-<span class="st"> </span>entire.mat[binary.index,]
y.vec &lt;-<span class="st"> </span>y.vec[binary.index]
testX.mat &lt;-<span class="st"> </span>X.mat[<span class="kw">c</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(X.mat)<span class="op">-</span><span class="dv">1</span>),]
max.neighbors &lt;-<span class="st"> </span>30L
fold.vec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.folds, <span class="dt">l =</span> <span class="kw">nrow</span>(X.mat)))

<span class="co">#------------------------------------------------------------------</span>
<span class="co">#-----------------------Prediction vs original data----------------</span>
C.pred.model &lt;-<span class="st"> </span><span class="kw">NNLearnCV</span>(X.mat, y.vec, max.neighbors, fold.vec, n.folds)
prediction.output &lt;-<span class="st"> </span>C.pred.model<span class="op">$</span><span class="kw">predict</span>(testX.mat)
original.output &lt;-<span class="st"> </span>y.vec[<span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">nrow</span>(X.mat))]
pred.vs.og &lt;-<span class="st"> </span><span class="kw">rbind</span>(original.output, prediction.output)
<span class="kw">colnames</span>(pred.vs.og) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Test1&quot;</span>,<span class="st">&quot;Test2&quot;</span>)
pred.vs.og
<span class="co">#&gt;                   Test1 Test2</span>
<span class="co">#&gt; original.output       1     1</span>
<span class="co">#&gt; prediction.output     1     0</span>
<span class="co">#-------------------------------------------------------------------------</span>

<span class="co"># ouput 2x3 matirx of nearst-neighbor-predicaton accuracy VS base-line prediction</span>
base.loss &lt;-<span class="st"> </span><span class="kw">binary.base.loss</span>(y.vec, fold.vec, n.folds)
nnp.predict.loss &lt;-<span class="st"> </span><span class="kw">colMeans</span>(C.pred.model<span class="op">$</span>validation.loss.mat)
nnploss.vs.baseloss &lt;-<span class="st"> </span><span class="kw">rbind</span>(nnp.predict.loss, base.loss)
<span class="kw">colnames</span>(nnploss.vs.baseloss) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Fold1&quot;</span>,<span class="st">&quot;Fold2&quot;</span>,<span class="st">&quot;Fold3&quot;</span>)
nnploss.vs.baseloss
<span class="co">#&gt;                         Fold1       Fold2        Fold3</span>
<span class="co">#&gt; nnp.predict.loss 0.0009095043 0.001364256 0.0009095043</span>
<span class="co">#&gt; base.loss        0.4433833561 0.466575716 0.4611186903</span></code></pre></div>
<div id="matrix-of-loss-values-2" class="section level3">
<h3>Matrix of loss values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(
  nnploss.vs.baseloss,
  <span class="dt">main =</span> <span class="st">&quot;Binary Classification: zip.train&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;mean loss value&quot;</span>,
  <span class="dt">legend =</span> (<span class="kw">rownames</span>(nnploss.vs.baseloss)),
  <span class="dt">beside =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Difference between NN and baseline: <strong>The mean loss value of the NN prediction is typically smaller than the Baseline prediction.</strong></p>
</div>
<div id="trainvalidation-loss-plot-2" class="section level3">
<h3>Train/validation loss plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dot.x &lt;-<span class="st"> </span>C.pred.model<span class="op">$</span>selected.neighbors
dot.y &lt;-<span class="st"> </span>C.pred.model<span class="op">$</span>validation.loss.vec[dot.x]

<span class="kw">matplot</span>(
  <span class="dt">y =</span> <span class="kw">cbind</span>(C.pred.model<span class="op">$</span>validation.loss.vec, C.pred.model<span class="op">$</span>train.loss.vec),
  <span class="dt">xlab =</span> <span class="st">&quot;neighbors&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;mean loss value&quot;</span>,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">pch =</span> <span class="dv">15</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">17</span>)
)

<span class="kw">matpoints</span>(<span class="dt">x =</span> dot.x,
          <span class="dt">y =</span> dot.y,
          <span class="dt">col =</span> <span class="dv">2</span>,
          <span class="dt">pch =</span> <span class="dv">19</span>)
<span class="kw">legend</span>(
  <span class="dt">x =</span> max.neighbors,
  <span class="dv">0</span>,
  <span class="kw">c</span>(<span class="st">&quot;Validation loss&quot;</span>, <span class="st">&quot;Train loss&quot;</span>),
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">xjust =</span> <span class="dv">1</span>,
  <span class="dt">yjust =</span> <span class="dv">0</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The optimal number of neighbors is: <strong>1</strong></p>
</div>
</div>
<div id="data-set-4-prostate" class="section level2">
<h2>Data set 4: prostate</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data 4: prostate</span>
<span class="kw">data</span>(prostate, <span class="dt">package =</span> <span class="st">&quot;ElemStatLearn&quot;</span>)
X.mat =<span class="st"> </span><span class="kw">data.matrix</span>(<span class="kw">subset</span>(prostate, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(lpsa, train)))
y.vec =<span class="st"> </span><span class="kw">as.vector</span>(prostate<span class="op">$</span>lpsa)
n.folds &lt;-<span class="st"> </span>3L
fold.vec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.folds, <span class="dt">l =</span> <span class="kw">nrow</span>(X.mat)))

NN.pred.mat &lt;-
<span class="st">  </span><span class="kw">NNLearnCV</span>(
    <span class="dt">X.mat =</span> X.mat,
    <span class="dt">y.vec =</span> y.vec,
    <span class="dt">fold.vec =</span> fold.vec,
    <span class="dt">n.folds =</span> n.folds
  )
NN.loss.vec &lt;-
NN.pred.mat<span class="op">$</span>train.loss.mat[NN.pred.mat<span class="op">$</span>selected.neighbors, ]
baseline.loss.vec &lt;-<span class="st"> </span><span class="kw">BaselinePredict</span>(y.vec, fold.vec, n.folds)
result &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">cbind</span>(NN.loss.vec, baseline.loss.vec))
<span class="kw">rownames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Nearest Neighbors&quot;</span>, <span class="st">&quot;Baseline&quot;</span>)
<span class="kw">colnames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Fold 1&quot;</span>, <span class="st">&quot;Fold 2&quot;</span>, <span class="st">&quot;Fold 3&quot;</span>)
result
<span class="co">#&gt;                      Fold 1    Fold 2    Fold 3</span>
<span class="co">#&gt; Nearest Neighbors 0.9895929 0.9884727 0.8995145</span>
<span class="co">#&gt; Baseline          1.5357899 1.1566992 1.2978894</span>
max.neighbors &lt;-<span class="st"> </span><span class="kw">length</span>(NN.pred.mat<span class="op">$</span>train.loss.vec)</code></pre></div>
<div id="matrix-of-loss-values-3" class="section level3">
<h3>Matrix of loss values</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(
  result,
  <span class="dt">main =</span> <span class="st">&quot;Regression: prostate&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;mean loss value&quot;</span>,
  <span class="dt">legend =</span> (<span class="kw">rownames</span>(result)),
  <span class="dt">beside =</span> <span class="ot">TRUE</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Difference between NN and baseline: <strong>The mean loss value of the NN prediction is typically smaller than the Baseline prediction.</strong></p>
</div>
<div id="trainvalidation-loss-plot-3" class="section level3">
<h3>Train/validation loss plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matplot</span>(
  <span class="dt">y =</span> <span class="kw">cbind</span>(NN.pred.mat<span class="op">$</span>validation.loss.vec, NN.pred.mat<span class="op">$</span>train.loss.vec),
  <span class="dt">xlab =</span> <span class="st">&quot;neighbors&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;mean loss value&quot;</span>,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">pch =</span> <span class="dv">15</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">17</span>)
)
dot.x &lt;-<span class="st"> </span>NN.pred.mat<span class="op">$</span>selected.neighbors
dot.y &lt;-<span class="st"> </span>NN.pred.mat<span class="op">$</span>validation.loss.vec[dot.x]
<span class="kw">matpoints</span>(<span class="dt">x =</span> dot.x,
          <span class="dt">y =</span> dot.y,
          <span class="dt">col =</span> <span class="dv">2</span>,
          <span class="dt">pch =</span> <span class="dv">19</span>)
<span class="kw">legend</span>(
  <span class="dt">x =</span> max.neighbors,
  <span class="dv">0</span>,
  <span class="kw">c</span>(<span class="st">&quot;Validation loss&quot;</span>, <span class="st">&quot;Train loss&quot;</span>),
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">xjust =</span> <span class="dv">1</span>,
  <span class="dt">yjust =</span> <span class="dv">0</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The optimal number of neighbors is: <strong>23</strong></p>
</div>
</div>
<div id="data-set-5-ozone" class="section level2">
<h2>Data set 5: ozone</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Data 5: ozone
<span class="kw">data</span>(ozone, <span class="dt">package =</span> <span class="st">&quot;ElemStatLearn&quot;</span>)
X.mat =<span class="st"> </span><span class="kw">data.matrix</span>(<span class="kw">subset</span>(ozone, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(ozone)))
y.vec =<span class="st"> </span><span class="kw">as.vector</span>(ozone<span class="op">$</span>ozone)
n.folds &lt;-<span class="st"> </span>3L
fold.vec &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n.folds, <span class="dt">l =</span> <span class="kw">nrow</span>(X.mat)))

NN.pred.mat &lt;-
<span class="st">  </span><span class="kw">NNLearnCV</span>(
    <span class="dt">X.mat =</span> X.mat,
    <span class="dt">y.vec =</span> y.vec,
    <span class="dt">fold.vec =</span> fold.vec,
    <span class="dt">n.folds =</span> n.folds
  )
NN.loss.vec &lt;-
NN.pred.mat<span class="op">$</span>train.loss.mat[NN.pred.mat<span class="op">$</span>selected.neighbors, ]
baseline.loss.vec &lt;-<span class="st"> </span><span class="kw">BaselinePredict</span>(y.vec, fold.vec, n.folds)
result &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">cbind</span>(NN.loss.vec, baseline.loss.vec))
<span class="kw">rownames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Nearest Neighbors&quot;</span>, <span class="st">&quot;Baseline&quot;</span>)
<span class="kw">colnames</span>(result) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Fold 1&quot;</span>, <span class="st">&quot;Fold 2&quot;</span>, <span class="st">&quot;Fold 3&quot;</span>)
result
<span class="co">#&gt;                     Fold 1   Fold 2    Fold 3</span>
<span class="co">#&gt; Nearest Neighbors 401.5346 570.6254  201.0346</span>
<span class="co">#&gt; Baseline          929.4217 863.1746 1533.0769</span>
max.neighbors &lt;-<span class="st"> </span><span class="kw">length</span>(NN.pred.mat<span class="op">$</span>train.loss.vec)
<span class="kw">barplot</span>(
  result,
  <span class="dt">main =</span> <span class="st">&quot;Regression: ozone&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;mean loss value&quot;</span>,
  <span class="dt">legend =</span> (<span class="kw">rownames</span>(result)),
  <span class="dt">beside =</span> <span class="ot">TRUE</span>
)
<span class="kw">matplot</span>(
  <span class="dt">y =</span> <span class="kw">cbind</span>(NN.pred.mat<span class="op">$</span>validation.loss.vec, NN.pred.mat<span class="op">$</span>train.loss.vec),
  <span class="dt">xlab =</span> <span class="st">&quot;neighbors&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;mean loss value&quot;</span>,
  <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">pch =</span> <span class="dv">15</span>,
  <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">17</span>)
)
dot.x &lt;-<span class="st"> </span>NN.pred.mat<span class="op">$</span>selected.neighbors
dot.y &lt;-<span class="st"> </span>NN.pred.mat<span class="op">$</span>validation.loss.vec[dot.x]
<span class="kw">matpoints</span>(<span class="dt">x =</span> dot.x,
          <span class="dt">y =</span> dot.y,
          <span class="dt">col =</span> <span class="dv">2</span>,
          <span class="dt">pch =</span> <span class="dv">19</span>)
<span class="kw">legend</span>(
  <span class="dt">x =</span> max.neighbors,
  <span class="dv">0</span>,
  <span class="kw">c</span>(<span class="st">&quot;Validation loss&quot;</span>, <span class="st">&quot;Train loss&quot;</span>),
  <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,
  <span class="dt">xjust =</span> <span class="dv">1</span>,
  <span class="dt">yjust =</span> <span class="dv">0</span>
)</code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<div id="matrix-of-loss-values-4" class="section level3">
<h3>Matrix of loss values</h3>
<p>Difference between NN and baseline: <strong>The mean loss value of the NN prediction is typically smaller than the Baseline prediction.</strong></p>
</div>
<div id="trainvalidation-loss-plot-4" class="section level3">
<h3>Train/validation loss plot</h3>
<p>The optimal number of neighbors is: <strong>5</strong></p>
</div>
</div>
<div id="end-of-the-report" class="section level2">
<h2>End of the report</h2>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
